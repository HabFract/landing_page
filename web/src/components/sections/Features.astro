---
// Features section matching section4.png design
interface FeatureItem {
  title: string;
  description: string;
  image: string;
}

interface IntegrationLogos {
  headline: string;
  description: string;
  ctaText: string;
  ctaUrl: string;
  logos: string[];
}

interface ProductCard {
  icon: string;
  iconColor: string;
  title: string;
  description: string;
  ctaText: string;
  ctaUrl: string;
}

interface Props {
  headline?: string;
  items?: FeatureItem[];
  integrations?: IntegrationLogos;
  products?: {
    headline: string;
    items: ProductCard[];
  };
}

const { headline, items, integrations, products } = Astro.props;
---

<section class="features">
  <div class="container">
    <!-- Main Features Grid -->
    {headline && items && (
      <>
        <h2 class="features__headline">{headline}</h2>
        <div class="features__grid">
          {
            items.map((item) => (
              <div class="features__card">
                <div class="features__image">
                  <img src={item.image} alt={item.title} />
                </div>
                <h3 class="features__title">{item.title}</h3>
                <p class="features__description">{item.description}</p>
              </div>
            ))
          }
        </div>
      </>
    )}

    <!-- Integrations Section -->
    {
      integrations && (
        <div class="integrations">
          <h2 class="integrations__headline">{integrations.headline}</h2>
          <p class="integrations__description">{integrations.description}</p>

          <div class="integrations__grid">
            {integrations.apps.map((app) => (
              <div class="integrations__card">
                <div class="integrations__icon" class:list={[app.name === 'Facebook' && 'integrations__icon--white-bg']}>
                  {app.icon.startsWith('/') ? (
                    <img src={app.icon} alt={app.name} />
                  ) : (
                    app.icon
                  )}
                </div>
                <span class="integrations__name">{app.name}</span>
              </div>
            ))}
          </div>

          <div class="integrations__footer">
            <p class="integrations__cta">
              {integrations.ctaText}
            </p>
          </div>
        </div>
      )
    }

    <!-- Products Section -->
    {
      products && (
        <div class="products">
          <h2 class="products__headline">{products.headline}</h2>
          <div class="products__grid">
            {products.items.map((product) => (
              <a href={product.ctaUrl} class="products__card">
                <div class="products__card-top">
                  <div class="products__icon">
                    {product.icon.startsWith('/') ? (
                      <img src={product.icon} alt={product.title} />
                    ) : (
                      product.icon
                    )}
                  </div>
                </div>
                <div class="products__card-bottom">
                  <h3 class="products__title">
                    {product.title} {product.ctaText}
                  </h3>
                  <p class="products__description">{product.description}</p>
                </div>
              </a>
            ))}
          </div>
        </div>
      )
    }
  </div>
</section>

<style>
  .features {
    background: #0a0a0a;
    color: white;
    padding-top: var(--space-4xl);
    padding-bottom: var(--space-4xl);
    /* Pull section up to overlap with fading testimonial */
    margin-top: -120px;
    position: relative;
  }

  .features .container {
    max-width: var(--container-xl);
    margin: 0 auto;
    padding: 0 var(--space-lg);
  }

  .features__headline {
    color: white;
    font-size: clamp(2rem, 4vw, 3rem);
    font-weight: var(--font-weight-bold);
    line-height: 1.2;
    margin-bottom: var(--space-3xl);
    max-width: 600px;
  }

  .features__grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: var(--space-2xl);
    margin-bottom: var(--space-4xl);
  }

  .features__card {
    background: #1a1a1a;
    border-radius: var(--radius-lg);
    padding: var(--space-xl);
    transition: all var(--transition-base);
  }

  .features__card:hover {
    background: #222;
    transform: translateY(-4px);
  }

  .features__image {
    margin-bottom: var(--space-md);
    border-radius: var(--radius-md);
    overflow: hidden;
    aspect-ratio: 16 / 9;
    background: #2a2a2a;
  }

  .features__image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .features__title {
    color: white;
    font-size: var(--font-size-lg);
    font-weight: var(--font-weight-semibold);
    margin-bottom: var(--space-xs);
  }

  .features__description {
    color: #999;
    font-size: var(--font-size-sm);
    line-height: var(--line-height-relaxed);
    margin: 0;
  }

  /* Integrations */
  .integrations {
    margin-top: var(--space-4xl);
    padding-top: var(--space-4xl);
    border-top: 1px solid #333;
    text-align: center;
  }

  .integrations__headline {
    color: white;
    font-size: clamp(1.75rem, 3.5vw, 2.5rem);
    font-weight: var(--font-weight-bold);
    line-height: 1.2;
    margin-bottom: var(--space-md);
  }

  .integrations__description {
    color: #999;
    font-size: var(--font-size-base);
    line-height: var(--line-height-relaxed);
    margin-bottom: var(--space-3xl);
  }

  .integrations__grid {
    display: grid;
    grid-template-columns: repeat(5, 1fr);
    gap: var(--space-md);
    margin-bottom: var(--space-xl);
    max-width: 1000px;
    margin-left: auto;
    margin-right: auto;
  }

  .integrations__card {
    background: white;
    border-radius: var(--radius-lg);
    padding: var(--space-lg);
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: var(--space-sm);
    transition: all var(--transition-base);
  }

  .integrations__card:hover {
    transform: translateY(-2px);
    box-shadow: var(--shadow-lg);
  }

  .integrations__icon {
    font-size: 1.5rem;
    flex-shrink: 0;
    height: 64px;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .integrations__icon img {
    width: 64px;
    height: 64px;
    object-fit: contain;
  }

  .integrations__icon--white-bg {
    background: white;
    border-radius: var(--radius-md);
  }

  .integrations__name {
    color: #1a1a1a;
    font-size: var(--font-size-sm);
    font-weight: var(--font-weight-medium);
    text-align: center;
  }

  .integrations__footer {
    margin-top: var(--space-2xl);
  }

  .integrations__cta {
    color: #FF9955;
    font-size: var(--font-size-xl);
    font-weight: var(--font-weight-semibold);
    margin: 0;
  }

  @media (max-width: 1024px) {
    .integrations__grid {
      grid-template-columns: repeat(4, 1fr);
    }
  }

  @media (max-width: 768px) {
    .integrations__grid {
      grid-template-columns: repeat(3, 1fr);
    }
  }

  @media (max-width: 480px) {
    .integrations__grid {
      grid-template-columns: repeat(2, 1fr);
    }
  }

  /* Products */
  .products {
    margin-top: var(--space-4xl);
    padding-top: var(--space-4xl);
  }

  .products__headline {
    color: white;
    font-size: clamp(1.75rem, 3.5vw, 2.5rem);
    font-weight: var(--font-weight-bold);
    line-height: 1.2;
    margin-bottom: var(--space-3xl);
  }

  .products__grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: var(--space-xl);
  }

  .products__card {
    background: #1a1a1a;
    border-radius: var(--radius-lg);
    text-decoration: none;
    display: flex;
    flex-direction: column;
    overflow: hidden;
    transition: all var(--transition-base);
  }

  .products__card:hover {
    transform: translateY(-4px);
  }

  .products__card-top {
    background: #f8f8f8;
    padding: var(--space-2xl);
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .products__card-bottom {
    background: #1a1a1a;
    padding: var(--space-2xl);
    flex: 1;
  }

  .products__card:hover .products__card-bottom {
    background: #222;
  }

  .products__icon {
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .products__icon img {
    max-width: 80px;
    max-height: 80px;
    width: auto;
    height: auto;
  }

  .products__title {
    color: white;
    font-size: var(--font-size-lg);
    font-weight: var(--font-weight-semibold);
    margin-bottom: var(--space-sm);
  }

  .products__description {
    color: #999;
    font-size: var(--font-size-sm);
    line-height: var(--line-height-relaxed);
    margin: 0;
  }

  @media (max-width: 768px) {
    .features__grid,
    .products__grid {
      grid-template-columns: 1fr;
    }

    .integrations__logos {
      grid-template-columns: repeat(4, 1fr);
    }
  }
</style>
